<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Introduction to the Tidyverse</title>
  
  <meta property="description" itemprop="description" content="An initial training on the philosophy and elements of the *tidyverse*."/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-01-14"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-01-14"/>
  <meta name="article:author" content="Bryan Blanc"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Introduction to the Tidyverse"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="An initial training on the philosophy and elements of the *tidyverse*."/>
  <meta property="og:locale" content="en_US"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Introduction to the Tidyverse"/>
  <meta property="twitter:description" content="An initial training on the philosophy and elements of the *tidyverse*."/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","categories"]}},"value":[{"type":"character","attributes":{},"value":["Introduction to the Tidyverse"]},{"type":"character","attributes":{},"value":["An initial training on the philosophy and elements of the *tidyverse*.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Bryan Blanc"]},{"type":"character","attributes":{},"value":["https://github.com/bpb824"]}]}]},{"type":"character","attributes":{},"value":["01-14-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["tidyverse","purrr"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/r_doodle.xls","graphics/diagrams/data-science.png","graphics/diagrams/lists-map2.png","graphics/diagrams/lists-pmap-named.png","graphics/diagrams/lists-pmap-unnamed.png","graphics/images/data-import.png","graphics/images/data-transformation.png","graphics/images/data-visualization-2.1.png","graphics/images/lubridate.png","graphics/images/purrr.png","graphics/images/tidy-1.png","graphics/images/tidy-12.png","graphics/images/tidy-13.png","graphics/images/tidy-14.png","graphics/images/tidy-15.png","graphics/images/tidy-16.png","graphics/images/tidy-17.png","graphics/images/tidy-18.png","graphics/images/tidy-8.png","graphics/images/tidy-9.png","tidyverse_files/anchor-4.2.2/anchor.min.js","tidyverse_files/bowser-1.9.3/bowser.min.js","tidyverse_files/distill-2.2.21/template.v2.js","tidyverse_files/figure-html5/shapes-1.png","tidyverse_files/figure-html5/unnamed-chunk-12-1.png","tidyverse_files/figure-html5/unnamed-chunk-14-1.png","tidyverse_files/figure-html5/unnamed-chunk-15-1.png","tidyverse_files/figure-html5/unnamed-chunk-16-1.png","tidyverse_files/figure-html5/unnamed-chunk-17-1.png","tidyverse_files/figure-html5/unnamed-chunk-18-1.png","tidyverse_files/figure-html5/unnamed-chunk-18-2.png","tidyverse_files/figure-html5/unnamed-chunk-19-1.png","tidyverse_files/figure-html5/unnamed-chunk-20-1.png","tidyverse_files/figure-html5/unnamed-chunk-21-1.png","tidyverse_files/figure-html5/unnamed-chunk-22-1.png","tidyverse_files/figure-html5/unnamed-chunk-22-2.png","tidyverse_files/figure-html5/unnamed-chunk-24-1.png","tidyverse_files/figure-html5/unnamed-chunk-25-1.png","tidyverse_files/figure-html5/unnamed-chunk-26-1.png","tidyverse_files/figure-html5/unnamed-chunk-26-2.png","tidyverse_files/figure-html5/unnamed-chunk-26-3.png","tidyverse_files/figure-html5/unnamed-chunk-27-1.png","tidyverse_files/figure-html5/unnamed-chunk-29-1.png","tidyverse_files/figure-html5/unnamed-chunk-30-1.png","tidyverse_files/figure-html5/unnamed-chunk-31-1.png","tidyverse_files/figure-html5/unnamed-chunk-62-1.png","tidyverse_files/jquery-1.11.3/jquery.min.js","tidyverse_files/popper-2.6.0/popper.min.js","tidyverse_files/tippy-6.2.7/tippy-bundle.umd.min.js","tidyverse_files/tippy-6.2.7/tippy-light-border.css","tidyverse_files/tippy-6.2.7/tippy.css","tidyverse_files/tippy-6.2.7/tippy.umd.min.js","tidyverse_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }
  
  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }
  
  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }
  
  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }
  
  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }
  
  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }
  
  d-article h3 {
    margin-top: 1.5rem;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  /* Tweak code blocks */
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }
  
  d-article div.sourceCode {
    background-color: white;
  }
  
  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  d-article pre a {
    border-bottom: none;
  }
  
  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }
  
  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }
  
  @media(min-width: 768px) {
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }
  
  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }
  
  d-article pre {
    font-size: 14px;
  }
  
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for d-contents */
  
  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }
  
  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }
  
  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .d-contents li {
    list-style-type: none
  }
  
  .d-contents nav > ul {
    padding-left: 0;
  }
  
  .d-contents ul {
    padding-left: 1em
  }
  
  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }
  
  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }
  
  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }
  
  .d-contents nav > ul > li > a {
    font-weight: 600;
  }
  
  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }
  
  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }
  
  
  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }
  
  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }
  
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  /* Citations */
  
  d-article .citation {
    color: inherit;
    cursor: inherit;
  }
  
  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }
  
  /* Citation hover box */
  
  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }
  
  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  /* Include appendix styles here so they can be overridden */
  
  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }
  
  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }
  
  d-appendix h3 + * {
    margin-top: 1em;
  }
  
  d-appendix ol {
    padding: 0 0 0 15px;
  }
  
  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }
  
  d-appendix li {
    margin-bottom: 1em;
  }
  
  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  d-appendix > * {
    grid-column: text;
  }
  
  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }
  
  /* Include footnote styles here so they can be overridden */
  
  d-footnote-list {
    contain: layout style;
  }
  
  d-footnote-list > * {
    grid-column: text;
  }
  
  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }
  
  
  
  /* Anchor.js */
  
  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }
  
  /* Styles for posts lists (not auto-injected) */
  
  
  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }
  
  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }
  
  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }
  
  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }
  
  .post-preview-last {
    border-bottom: none !important;
  }
  
  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }
  
  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }
  
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }
  
  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }
  
  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }
  
  .posts-list .metadata > * {
    display: inline-block;
  }
  
  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }
  
  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }
  
  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }
  
  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  .posts-list img {
    opacity: 1;
  }
  
  .posts-list img[data-src] {
    opacity: 0;
  }
  
  .posts-more {
    clear: both;
  }
  
  
  .posts-sidebar {
    font-size: 16px;
  }
  
  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }
  
  .sidebar-section {
    margin-bottom: 30px;
  }
  
  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  
  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }
  
  .categories li>a {
    border-bottom: none;
  }
  
  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }
  
  .categories .active {
    font-weight: 600;
  }
  
  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }
  
  
  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  .downlevel .posts-list .post-preview {
    color: inherit;
  }
  
  
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }
  
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();
  
    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-contents').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="tidyverse_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="tidyverse_files/popper-2.6.0/popper.min.js"></script>
  <link href="tidyverse_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="tidyverse_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="tidyverse_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="tidyverse_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="tidyverse_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="tidyverse_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="tidyverse_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Introduction to the Tidyverse","description":"An initial training on the philosophy and elements of the *tidyverse*.","authors":[{"author":"Bryan Blanc","authorURL":"https://github.com/bpb824","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-01-14T00:00:00.000-08:00","citationText":"Blanc, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Introduction to the Tidyverse</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">tidyverse</div>
<div class="dt=tag">purrr</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>An initial training on the philosophy and elements of the <em>tidyverse</em>.</p></p>
</div>

<div class="d-byline">
  Bryan Blanc <a href="https://github.com/bpb824" class="uri">https://github.com/bpb824</a> 
  
<br/>01-14-2021
</div>

<div class="d-article">
<p><em>This content was presented to Nelson\Nygaard Staff at a Lunch and Learn webinar on Friday, August 21st, 2020, and is <a href="https://web.microsoftstream.com/video/33fc95ba-c50e-4ac0-b9e4-118217352133">available as a recording here</a> and embedded below</em></p>
<p align="center">
<iframe width="640" height="360" src="https://web.microsoftstream.com/embed/video/33fc95ba-c50e-4ac0-b9e4-118217352133?autoplay=false&amp;showinfo=true" allowfullscreen style="border:none;">
</iframe>
</p>
<h2 id="introduction">Introduction</h2>
<p>The <a href="https://www.tidyverse.org/">Tidyverse</a> is a ‘universe’ of packages designed for data science with R. They are all built with an underlying design philosophy and grammar based on the <a href="https://vita.had.co.nz/papers/tidy-data.pdf">concept of ‘tidy’ data</a>. This session will discuss the tidy data concept and its main package implementations. For me, the tidy data concept influences not just the work I do in R but how I structure spreadsheets and datasets in general, and I have found it to generally result in cleaner data analyses.<a href="https://www.tidyverse.org/packages/">Tidyverse packages</a> are among the most widely used R packages, and greatly improve upon implementations of basic operations in base R.</p>
<p><strong>Acknowledgement:</strong> This module heavily draws upon Hadley Wickham’s (the progenitor of the Tidyverse) book (available for free online), <a href="https://r4ds.had.co.nz/">R for Data Science</a>, including text, pictures, and code directly copied from that book and slightly modified to suit a shorter narrative. Printed copies are available generally wherever you get your books. It is recommended that you read this book for a deeper understanding of the topics contained hereien – only basic concepts are able to be covered within the time available.</p>
<h2 id="a-note-on-packages">A Note on Packages</h2>
<p>For those that don’t remember what packages are in R – packages are collections of functions developed with a specific purpose in mind; typically a particular topic, data analysis method, or type of data is the focus of a package. Packages include the functions that comprise them as well as documentation, sample datasets for examples, and ‘vignettes’, which are example implementations of the code interspersed with narrative. Depending on how well the package has been documented, there may be more or less of these supplementary items. The most useful packages in R are typically those that are well documented.</p>
<p>There are thousands of R packages, and because of the open source nature of R, anyone can develop a package and post it online. The two main places to get packages are CRAN (Comprehensive R Archive Network) and GitHub. For packages to be uploaded to CRAN, they must meet a minimum standard of documentation and unit testing of code, to ensure some minimum quality of the packages. Packages on GitHub have no standard – they are hosted by individuals. That said, there is information in the GitHub READMEs about how well the code has been unit tested, and packages are typically only hosted on GitHub in the development phase. If you want the most ‘bleeding edge’ version of a package (maybe some new features in development are really helpful!), go to GitHub, but if you want the most stable version, go to CRAN.</p>
<p>A helpful place to start if you have a goal in mind for your R code but you don’t know which packages can help is the <a href="https://cran.r-project.org/web/views/">CRAN Task View Page</a>. It is a well maintained list of package topics, including some narrative description of what packages do what within each topic. For example, we might want to check out the <a href="https://cran.r-project.org/web/views/Spatial.html">Spatial task view</a>. There we can see the many packages developed with spatial analysis in mind.</p>
<p>Another place to go is Google 🤓 – there is a widespread (and well documented) R community on GitHub, StackOverflow, and various R blogs that can help put you on the right path. Chances are someone has had the same question as you (typically many someones), and if they haven’t, then you might have a package to develop on your hands…</p>
<h2 id="tidyverse-packages">Tidyverse Packages</h2>
<p>As mentioned above, the Tidyverse consists of a collection of R packages – several of the key packages are highlighted below.</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org">ggplot2</a>, for data visualisation.</li>
<li><a href="https://dplyr.tidyverse.org">dplyr</a>, for data manipulation.</li>
<li><a href="https://tidyr.tidyverse.org">tidyr</a>, for data tidying.</li>
<li><a href="https://readr.tidyverse.org">readr</a>, for data import.</li>
<li><a href="https://purrr.tidyverse.org">purrr</a>, for functional programming.</li>
<li><a href="https://tibble.tidyverse.org">tibble</a>, for tibbles, a modern re-imagining of data frames.</li>
<li><a href="https://github.com/tidyverse/stringr">stringr</a>, for character strings.</li>
<li><a href="https://github.com/hadley/forcats">forcats</a>, for factors.</li>
</ul>
<p>Conveniently, Hadley and RStudio created a <a href="https://tidyverse.tidyverse.org/"><code>tidyverse</code></a> package, which with a single installation command (<code>install.packages(tidyverse)</code>) will install the above packages, and with a single library command (<code>library(tidyverse)</code>) will load those packages into your environment.</p>
<p>You also get a condensed summary of conflicts with other packages you have loaded:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>You can see conflicts created later with <code>tidyverse_conflicts()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span>
<span class='fu'><a href='https://tidyverse.tidyverse.org/reference/tidyverse_conflicts.html'>tidyverse_conflicts</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>-- Conflicts -------------------------------- tidyverse_conflicts() --
x lubridate::as.difftime() masks base::as.difftime()
x scales::col_factor()     masks readr::col_factor()
x lubridate::date()        masks base::date()
x scales::discard()        masks purrr::discard()
x dplyr::filter()          masks stats::filter()
x lubridate::hms()         masks hms::hms()
x rgeos::intersect()       masks lubridate::intersect(), base::intersect()
x dplyr::lag()             masks stats::lag()
x MASS::select()           masks dplyr::select()
x rgeos::setdiff()         masks lubridate::setdiff(), base::setdiff()
x rgeos::union()           masks lubridate::union(), base::union()</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/detach.html'>detach</a></span><span class='op'>(</span><span class='st'>"package:MASS"</span>, unload<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>As well as the core tidyverse, installing this package also installs a selection of other packages that you’re likely to use frequently, but probably not in every analysis. This means they are installed, but not loaded by defaault, so if you want to use them you will need to load them with a <code>library()</code> call. This includes packages for:</p>
<ul>
<li><p>Working with specific types of vectors:</p>
<ul>
<li><a href="https://github.com/rstats-db/hms">hms</a>, for times.</li>
<li><a href="https://github.com/tidyverse/lubridate">lubridate</a>, for date/times.</li>
</ul></li>
<li><p>Importing other types of data:</p>
<ul>
<li><a href="https://github.com/wesm/feather">feather</a>, for sharing with Python and other languages.</li>
<li><a href="https://github.com/tidyverse/haven">haven</a>, for SPSS, SAS and Stata files.</li>
<li><a href="https://github.com/r-lib/httr">httr</a>, for web apis.</li>
<li><a href="https://github.com/jeroen/jsonlite">jsonlite</a> for JSON.</li>
<li><a href="https://github.com/tidyverse/readxl">readxl</a>, for <code>.xls</code> and <code>.xlsx</code> files.</li>
<li><a href="https://github.com/tidyverse/rvest">rvest</a>, for web scraping.</li>
<li><a href="https://github.com/r-lib/xml2">xml2</a>, for XML.</li>
</ul></li>
<li><p>Modeling</p>
<ul>
<li><a href="https://github.com/tidyverse/modelr">modelr</a>, for modelling within a pipeline</li>
<li><a href="https://github.com/tidymodels/broom">broom</a>, for turning models into tidy data</li>
</ul></li>
</ul>
<p>And you can check that all tidyverse packages are up-to-date with <code>tidyverse_update()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://tidyverse.tidyverse.org/reference/tidyverse_update.html'>tidyverse_update</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='co'>#&gt; The following packages are out of date:</span>
<span class='co'>#&gt;  * broom (0.4.0 -&gt; 0.4.1)</span>
<span class='co'>#&gt;  * DBI   (0.4.1 -&gt; 0.5)</span>
<span class='co'>#&gt;  * Rcpp  (0.12.6 -&gt; 0.12.7)</span>
<span class='co'>#&gt; Update now?</span>
<span class='co'>#&gt; </span>
<span class='co'>#&gt; 1: Yes</span>
<span class='co'>#&gt; 2: No</span>
</code></pre>
</div>
</div>
<h2 id="the-key-parts-of-the-tidyverse-model-of-data-science">The Key Parts of the Tidyverse Model of Data Science</h2>
<p>Hadley proposes a model that nearly all data science projects approximate, described by the below illustration. This course module will mostly focus upon three of these concepts – tidying, transforming, and visualizing. The other topics will be touched on in other course modules. A deeper dive is needed on all these topics for a well rounded data science professional, and it is again recommended to refer to <a href="https://r4ds.had.co.nz/">R for Data Science</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="graphics/diagrams/data-science.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="tidy-data">Tidy Data</h2>
<h3 id="what-is-tidy-data">What is Tidy Data?</h3>
<p>You can represent the same underlying data in multiple ways. The example below shows the same data organised in four different ways. Each dataset shows the same values of four variables <em>country</em>, <em>year</em>, <em>population</em>, and <em>cases</em>, but each dataset organises the values in a different way.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table1</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 4
  country      year  cases population
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table2</span>
</code></pre>
</div>
<pre><code># A tibble: 12 x 4
   country      year type            count
   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table3</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 3
  country      year rate             
* &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Spread across two tibbles</span>
<span class='va'>table4a</span>  <span class='co'># cases</span>
</code></pre>
</div>
<pre><code># A tibble: 3 x 3
  country     `1999` `2000`
* &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table4b</span>  <span class='co'># population</span>
</code></pre>
</div>
<pre><code># A tibble: 3 x 3
  country         `1999`     `2000`
* &lt;chr&gt;            &lt;int&gt;      &lt;int&gt;
1 Afghanistan   19987071   20595360
2 Brazil       172006362  174504898
3 China       1272915272 1280428583</code></pre>
</div>
<p>These are all representations of the same underlying data, but they are not equally easy to use. One dataset, the tidy dataset, will be much easier to work with inside the tidyverse.</p>
<p>There are three interrelated rules which make a dataset tidy:</p>
<ol type="1">
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ol>
<p>The below illustration shows the rules visually: "Following three rules makes a dataset tidy: variables are in columns, observations are in rows, and values are in cells.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="graphics/images/tidy-1.png" width="100%" /></p>
</div>
<p>These three rules are interrelated because it’s impossible to only satisfy two of the three. That interrelationship leads to an even simpler set of practical instructions:</p>
<ol type="1">
<li>Put each dataset in a tibble.</li>
<li>Put each variable in a column.</li>
</ol>
<p>In this example, only <code>table1</code> is tidy. It’s the only representation where each column is a variable.</p>
<p>Why ensure that your data is tidy? There are two main advantages:</p>
<ol type="1">
<li><p>There’s a general advantage to picking one consistent way of storing data. If you have a consistent data structure, it’s easier to learn the tools that work with it because they have an underlying uniformity.</p></li>
<li><p>There’s a specific advantage to placing variables in columns because it allows R’s vectorised nature to shine. Most built-in R functions work with vectors of values. That makes transforming tidy data feel particularly natural.</p></li>
</ol>
<p><code>dplyr</code>, <code>ggplot2</code>, and all the other packages in the tidyverse are designed to work with tidy data.</p>
<h3 id="tidying">Tidying</h3>
<h4 id="pivoting">Pivoting</h4>
<p>The principles of tidy data seem so obvious that you might wonder if you’ll ever encounter a dataset that isn’t tidy. Unfortunately, however, most data that you will encounter will be untidy. There are two main reasons:</p>
<ol type="1">
<li><p>Most people aren’t familiar with the principles of tidy data, and it’s hard to derive them yourself unless you spend a <em>lot</em> of time working with data.</p></li>
<li><p>Data is often organized to facilitate some use other than analysis. For example, data is often organized to make entry as easy as possible.</p></li>
</ol>
<p>This means for most real analyses, you’ll need to do some tidying. The first step is always to figure out what the variables and observations are. Sometimes this is easy; other times you’ll need to consult with the people who originally generated the data. The second step is to resolve one of two common problems:</p>
<ol type="1">
<li><p>One variable might be spread across multiple columns.</p></li>
<li><p>One observation might be scattered across multiple rows.</p></li>
</ol>
<p>Typically a dataset will only suffer from one of these problems; it’ll only suffer from both if you’re really unlucky! To fix these problems, you’ll need the two most important functions in tidyr: <code>pivot_longer()</code> and <code>pivot_wider()</code>.</p>
<h4 id="separating-and-uniting">Separating and uniting</h4>
<p>So far you’ve learned how to tidy <code>table2</code> and <code>table4</code>, but not <code>table3</code>. <code>table3</code> has a different problem: we have one column (<code>rate</code>) that contains two variables (<code>cases</code> and <code>population</code>). To fix this problem, we’ll need the <code>separate()</code> function. You’ll also learn about the complement of <code>separate()</code>: <code>unite()</code>, which you use if a single variable is spread across multiple columns.</p>
<h5 id="separate">Separate</h5>
<p><code>separate()</code> pulls apart one column into multiple columns, by splitting wherever a separator character appears. Take <code>table3</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table3</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 3
  country      year rate             
* &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
<p>The <code>rate</code> column contains both <code>cases</code> and <code>population</code> variables, and we need to split it into two variables. <code>separate()</code> takes the name of the column to separate, and the names of the columns to separate into, as shown in Figure <a href="#fig:tidy-separate">1</a> and the code below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table3</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>rate</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cases"</span>, <span class='st'>"population"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 4
  country      year cases  population
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span id="fig:tidy-separate"></span>
<img src="graphics/images/tidy-17.png" alt="Separating `table3` makes it tidy" width="75%" />
<p class="caption">
Figure 1: Separating <code>table3</code> makes it tidy
</p>
</div>
</div>
<p>By default, <code>separate()</code> will split values wherever it sees a non-alphanumeric character (i.e. a character that isn’t a number or letter). For example, in the code above, <code>separate()</code> split the values of <code>rate</code> at the forward slash characters. If you wish to use a specific character to separate a column, you can pass the character to the <code>sep</code> argument of <code>separate()</code>. For example, we could rewrite the code above as:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table3</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>rate</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cases"</span>, <span class='st'>"population"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>(Formally, <code>sep</code> is a regular expression, which you’ll learn more about in [strings].)</p>
<p>Look carefully at the column types: you’ll notice that <code>cases</code> and <code>population</code> are character columns. This is the default behaviour in <code>separate()</code>: it leaves the type of the column as is. Here, however, it’s not very useful as those really are numbers. We can ask <code>separate()</code> to try and convert to better types using <code>convert = TRUE</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table3</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>rate</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cases"</span>, <span class='st'>"population"</span><span class='op'>)</span>, convert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 4
  country      year  cases population
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<p>You can also pass a vector of integers to <code>sep</code>. <code>separate()</code> will interpret the integers as positions to split at. Positive values start at 1 on the far-left of the strings; negative value start at -1 on the far-right of the strings. When using integers to separate strings, the length of <code>sep</code> should be one less than the number of names in <code>into</code>.</p>
<p>You can use this arrangement to separate the last two digits of each year. This make this data less tidy, but is useful in other cases, as you’ll see in a little bit.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table3</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>year</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"century"</span>, <span class='st'>"year"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
<h5 id="unite">Unite</h5>
<p><code>unite()</code> is the inverse of <code>separate()</code>: it combines multiple columns into a single column. You’ll need it much less frequently than <code>separate()</code>, but it’s still a useful tool to have in your back pocket.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span id="fig:tidy-unite"></span>
<img src="graphics/images/tidy-18.png" alt="Uniting `table5` makes it tidy" width="75%" />
<p class="caption">
Figure 2: Uniting <code>table5</code> makes it tidy
</p>
</div>
</div>
<p>We can use <code>unite()</code> to rejoin the <em>century</em> and <em>year</em> columns that we created in the last example. That data is saved as <code>tidyr::table5</code>. <code>unite()</code> takes a data frame, the name of the new variable to create, and a set of columns to combine, again specified in <code>dplyr::select()</code> style:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table5</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>unite</span><span class='op'>(</span><span class='va'>new</span>, <span class='va'>century</span>, <span class='va'>year</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 3
  country     new   rate             
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19_99 745/19987071     
2 Afghanistan 20_00 2666/20595360    
3 Brazil      19_99 37737/172006362  
4 Brazil      20_00 80488/174504898  
5 China       19_99 212258/1272915272
6 China       20_00 213766/1280428583</code></pre>
</div>
<p>In this case we also need to use the <code>sep</code> argument. The default will place an underscore (<code>_</code>) between the values from different columns. Here we don’t want any separator so we use <code>""</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table5</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>unite</span><span class='op'>(</span><span class='va'>new</span>, <span class='va'>century</span>, <span class='va'>year</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 3
  country     new   rate             
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 1999  745/19987071     
2 Afghanistan 2000  2666/20595360    
3 Brazil      1999  37737/172006362  
4 Brazil      2000  80488/174504898  
5 China       1999  212258/1272915272
6 China       2000  213766/1280428583</code></pre>
</div>
<h4 id="cheat-sheet">Cheat Sheet</h4>
<p>A handy sheet to have on hand is RStudio’s <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">Data Import Cheat Sheet</a> – this will give you a high level overview of the functions for both reading in data and then tidying. Note that this cheat sheet has not yet been updated with the switch to <code>pivot_*</code> functions from <code>gather()</code> and <code>spread()</code>, but I would expect an update soon.</p>
<p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf"><img src="graphics/images/data-import.png" alt="Data Import Cheat Sheet" /></a></p>
<h3 id="transforming">Transforming</h3>
<h4 id="general">General</h4>
<p>Before we start an example, a note about <strong>transforming</strong>, to get us back to the Data Science framework we referred to above. Typically, after you tidy your data, there will be value in additional columns that you add to that data by transforming it in some way - generally these are added using the <code>mutate()</code> function. This can be as simple as extracting the <strong>year</strong> value from your <strong>date</strong> column, or something more complex, like assigning a geographic zone to a record (we will do this in the geospatial data module). Transforming is part of your script that adds value after your data has typically already been tidied but before it is used for visuzalation or modeling. We will do some transformations in the below example.</p>
<p>Again, RStudio has a handy <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">cheat sheet for data transformation</a>, which might be especially useful to you since we did not cover that topic in depth here.</p>
<p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf"><img src="graphics/images/data-transformation.png" alt="Data Transformation Cheat Sheet" /></a></p>
<h4 id="dates-and-times">Dates and Times</h4>
<p>A key part of the transformations we are doing below has to do with working with date and time data in R, which can have a learning curve – it is recommended to look at this cheat sheet, and for further learning to take a DataCamp course referenced at the bottom of this page. As with anything in R, the best way to learn is by doing.</p>
<p><a href="https://github.com/rstudio/cheatsheets/raw/master/lubridate.pdf"><img src="graphics/images/lubridate.png" alt="Dates and Times Cheat Sheet" /></a></p>
<h3 id="example-part-a">Example: Part A</h3>
<p>In submitting your interest for R training, you all generated some data that could use some tidying – let’s take a look at your Doodle responses below.</p>
<p>Some notes on the below code block:</p>
<ul>
<li><strong>The Pipe:</strong> If you are not familiar with the <code>%&gt;%</code> operator (known as ‘the pipe operator’), meet your new best friend! It comes from the <code>magrittr</code> R package (part of the tidyverse) and gets rid of the need to nest multiple parentheses. Pass the result of one function directly into the first argument of the next.</li>
<li><strong>A note on <code>pivot_*</code> functions:</strong> I (Bryan) did not realize prior to developing this course that <code>gather()</code> and <code>spread()</code> were no longer the preferred way of converting between longer and wider data formats, so I am learning this new preferred implementation along with you! Instead of <code>gather()</code>, we should be using <code>pivot_longer()</code>, and instead of <code>spread()</code> we should be using <code>pivot_wider()</code>. The old functions still work but they are no longer being actively improved. If the old functions mean nothing to you, then don’t worry about this note!</li>
<li><strong>There are many ways to do this:</strong> going from messy data to tidy data is not a straight line. You can use the functions below in a different order (or use different functions!) that can take more or less lines of code – do this in the way that best makes sense to you and still gives you the result you want. Experiment using different lines to get to the same result!</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span> <span class='co'>#Loading the tidyverse</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span> <span class='co'>#For reading Excel files</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sfirke/janitor'>janitor</a></span><span class='op'>)</span> <span class='co'>#For cleaning up column names</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://forcats.tidyverse.org'>forcats</a></span><span class='op'>)</span> <span class='co'>#For implementing ordered categorical </span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://hms.tidyverse.org/'>hms</a></span><span class='op'>)</span> <span class='co'>#For working with times of day</span>

<span class='va'>raw_doodle</span> <span class='op'>=</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>'data/r_doodle.xls'</span><span class='op'>)</span>

<span class='co'>#Take a look at data in R studio viewer and in Excel. </span>
<span class='co'>#Column names are weird, the information we want is several rows down from the top. </span>
<span class='co'>#Luckily we can use skip some rows and rename columns to make them easier to manipulate</span>

<span class='va'>raw_doodle</span>
</code></pre>
</div>
<pre><code># A tibble: 26 x 74
   `Poll &quot;Weekly R~ ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9 
   &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 https://doodle.~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 2 &lt;NA&gt;             &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 3 &lt;NA&gt;             Augu~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 4 &lt;NA&gt;             Mon ~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 5 &lt;NA&gt;             8:00~ 8:30~ 9:00~ 11:0~ 11:3~ 12:0~ 12:3~ 1:00~
 6 Mariel Kirschen  OK    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  OK    OK    OK   
 7 Ayaka Habu       &lt;NA&gt;  OK    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 8 Paul Leitman     OK    OK    OK    OK    OK    OK    &lt;NA&gt;  &lt;NA&gt; 
 9 Michael Carraher &lt;NA&gt;  OK    OK    &lt;NA&gt;  &lt;NA&gt;  OK    OK    OK   
10 Esther Needham   OK    OK    OK    &lt;NA&gt;  OK    OK    OK    OK   
# ... with 16 more rows, and 65 more variables: ...10 &lt;chr&gt;,
#   ...11 &lt;chr&gt;, ...12 &lt;chr&gt;, ...13 &lt;chr&gt;, ...14 &lt;chr&gt;, ...15 &lt;chr&gt;,
#   ...16 &lt;chr&gt;, ...17 &lt;chr&gt;, ...18 &lt;chr&gt;, ...19 &lt;chr&gt;, ...20 &lt;chr&gt;,
#   ...21 &lt;chr&gt;, ...22 &lt;chr&gt;, ...23 &lt;chr&gt;, ...24 &lt;chr&gt;, ...25 &lt;chr&gt;,
#   ...26 &lt;chr&gt;, ...27 &lt;chr&gt;, ...28 &lt;chr&gt;, ...29 &lt;chr&gt;, ...30 &lt;chr&gt;,
#   ...31 &lt;chr&gt;, ...32 &lt;chr&gt;, ...33 &lt;chr&gt;, ...34 &lt;chr&gt;, ...35 &lt;chr&gt;,
#   ...36 &lt;chr&gt;, ...37 &lt;chr&gt;, ...38 &lt;chr&gt;, ...39 &lt;chr&gt;, ...40 &lt;chr&gt;,
#   ...41 &lt;chr&gt;, ...42 &lt;chr&gt;, ...43 &lt;chr&gt;, ...44 &lt;chr&gt;, ...45 &lt;chr&gt;,
#   ...46 &lt;chr&gt;, ...47 &lt;chr&gt;, ...48 &lt;chr&gt;, ...49 &lt;chr&gt;, ...50 &lt;chr&gt;,
#   ...51 &lt;chr&gt;, ...52 &lt;chr&gt;, ...53 &lt;chr&gt;, ...54 &lt;chr&gt;, ...55 &lt;chr&gt;,
#   ...56 &lt;chr&gt;, ...57 &lt;chr&gt;, ...58 &lt;chr&gt;, ...59 &lt;chr&gt;, ...60 &lt;chr&gt;,
#   ...61 &lt;chr&gt;, ...62 &lt;chr&gt;, ...63 &lt;chr&gt;, ...64 &lt;chr&gt;, ...65 &lt;chr&gt;,
#   ...66 &lt;chr&gt;, ...67 &lt;chr&gt;, ...68 &lt;chr&gt;, ...69 &lt;chr&gt;, ...70 &lt;chr&gt;,
#   ...71 &lt;chr&gt;, ...72 &lt;chr&gt;, ...73 &lt;chr&gt;, ...74 &lt;chr&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Let's try to fix a few things at first</span>
<span class='va'>less_raw_doodle</span> <span class='op'>=</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>'data/r_doodle.xls'</span>,skip <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#Skipping three rows, we will need both weekday and time data from top two new rows</span>
  <span class='fu'><a href='https://rdrr.io/pkg/janitor/man/clean_names.html'>clean_names</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span><span class='co'>#Cleaning names to make them easier to use, R likes names that don't have spaces, special characters, or leading numbers. </span>
  <span class='fu'>rename</span><span class='op'>(</span>x2 <span class='op'>=</span> <span class='va'>august_2020</span>, <span class='co'># We don't need to know that it is August 2020</span>
         name <span class='op'>=</span> <span class='va'>x1</span><span class='op'>)</span> <span class='co'>#Name is going to be our primary identifier </span>
  
<span class='co'>#Take a look at the newly read in dataset</span>
<span class='va'>less_raw_doodle</span>
</code></pre>
</div>
<pre><code># A tibble: 23 x 74
   name   x2     x3    x4    x5    x6    x7    x8    x9    x10   x11  
   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 &lt;NA&gt;   Mon 10 &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 2 &lt;NA&gt;   8:00 ~ 8:30~ 9:00~ 11:0~ 11:3~ 12:0~ 12:3~ 1:00~ 1:30~ 2:00~
 3 Marie~ OK     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  OK    OK    OK    OK    OK   
 4 Ayaka~ &lt;NA&gt;   OK    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 5 Paul ~ OK     OK    OK    OK    OK    OK    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  OK   
 6 Micha~ &lt;NA&gt;   OK    OK    &lt;NA&gt;  &lt;NA&gt;  OK    OK    OK    OK    OK   
 7 Esthe~ OK     OK    OK    &lt;NA&gt;  OK    OK    OK    OK    OK    OK   
 8 Ashan~ OK     OK    OK    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  OK    OK    OK    OK   
 9 Tomok~ &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  OK   
10 Techa~ OK     OK    OK    OK    OK    OK    OK    OK    OK    &lt;NA&gt; 
# ... with 13 more rows, and 63 more variables: x12 &lt;chr&gt;, x13 &lt;chr&gt;,
#   x14 &lt;chr&gt;, x15 &lt;chr&gt;, x16 &lt;chr&gt;, x17 &lt;chr&gt;, x18 &lt;chr&gt;, x19 &lt;chr&gt;,
#   x20 &lt;chr&gt;, x21 &lt;chr&gt;, x22 &lt;chr&gt;, x23 &lt;chr&gt;, x24 &lt;chr&gt;, x25 &lt;chr&gt;,
#   x26 &lt;chr&gt;, x27 &lt;chr&gt;, x28 &lt;chr&gt;, x29 &lt;chr&gt;, x30 &lt;chr&gt;, x31 &lt;chr&gt;,
#   x32 &lt;chr&gt;, x33 &lt;chr&gt;, x34 &lt;chr&gt;, x35 &lt;chr&gt;, x36 &lt;chr&gt;, x37 &lt;chr&gt;,
#   x38 &lt;chr&gt;, x39 &lt;chr&gt;, x40 &lt;chr&gt;, x41 &lt;chr&gt;, x42 &lt;chr&gt;, x43 &lt;chr&gt;,
#   x44 &lt;chr&gt;, x45 &lt;chr&gt;, x46 &lt;chr&gt;, x47 &lt;chr&gt;, x48 &lt;chr&gt;, x49 &lt;chr&gt;,
#   x50 &lt;chr&gt;, x51 &lt;chr&gt;, x52 &lt;chr&gt;, x53 &lt;chr&gt;, x54 &lt;chr&gt;, x55 &lt;chr&gt;,
#   x56 &lt;chr&gt;, x57 &lt;chr&gt;, x58 &lt;chr&gt;, x59 &lt;chr&gt;, x60 &lt;chr&gt;, x61 &lt;chr&gt;,
#   x62 &lt;chr&gt;, x63 &lt;chr&gt;, x64 &lt;chr&gt;, x65 &lt;chr&gt;, x66 &lt;chr&gt;, x67 &lt;chr&gt;,
#   x68 &lt;chr&gt;, x69 &lt;chr&gt;, x70 &lt;chr&gt;, x71 &lt;chr&gt;, x72 &lt;chr&gt;, x73 &lt;chr&gt;,
#   x74 &lt;chr&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#We're going to break this data down into a couple of parts and join it back together </span>

<span class='co'>#Time preferences</span>
<span class='va'>time_prefs</span> <span class='op'>=</span> <span class='va'>less_raw_doodle</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#Get only the rows with people's time preferences indicated</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'>starts_with</span><span class='op'>(</span><span class='st'>'x'</span><span class='op'>)</span>, <span class='co'>#All columns except name</span>
               names_to <span class='op'>=</span> <span class='st'>'key'</span>, <span class='co'>#Old convention from gather</span>
               values_to<span class='op'>=</span><span class='st'>'value'</span><span class='op'>)</span> <span class='co'>#Old convention from gather</span>

<span class='co'>#Time block definitions</span>
<span class='va'>time_blocks</span> <span class='op'>=</span> <span class='va'>less_raw_doodle</span> <span class='op'>%&gt;%</span>
  <span class='fu'>slice</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#Extract first two rows</span>
  <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/lm.ridge.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>name</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#Do not need name column here</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'>everything</span><span class='op'>(</span><span class='op'>)</span>, <span class='co'>#All columns</span>
               names_to <span class='op'>=</span> <span class='st'>'key'</span>,
               values_to <span class='op'>=</span> <span class='st'>'value'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fill</span><span class='op'>(</span><span class='va'>value</span>,.direction <span class='op'>=</span> <span class='st'>'down'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>col_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>value</span>,<span class='st'>':'</span><span class='op'>)</span>,<span class='st'>'time'</span>,<span class='st'>'date'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_wider</span><span class='op'>(</span>id_cols <span class='op'>=</span> <span class='va'>key</span>,
              names_from<span class='op'>=</span><span class='va'>col_type</span>,
              values_from<span class='op'>=</span><span class='va'>value</span><span class='op'>)</span>

<span class='co'>#Join the split dataset back together</span>
<span class='va'>time_prefs_joined</span> <span class='op'>=</span> <span class='va'>time_prefs</span> <span class='op'>%&gt;%</span>
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>time_blocks</span>,by<span class='op'>=</span><span class='st'>'key'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/lm.ridge.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>key</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#Do not need this anymore</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>name</span><span class='op'>!=</span><span class='st'>'Count'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>value <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='va'>value</span><span class='op'>==</span><span class='st'>'OK'</span><span class='op'>~</span><span class='st'>'Yes'</span>,
    <span class='va'>value</span><span class='op'>==</span><span class='st'>'(OK)'</span><span class='op'>~</span><span class='st'>'Maybe'</span>,
    <span class='cn'>TRUE</span><span class='op'>~</span><span class='st'>'No'</span>
  <span class='op'>)</span>,
  value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>value</span>,ordered<span class='op'>=</span><span class='cn'>TRUE</span>,levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Yes'</span>,<span class='st'>'Maybe'</span>,<span class='st'>'No'</span><span class='op'>)</span><span class='op'>)</span>,
  weekday <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>date</span>,<span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span>,
  weekday <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>weekday</span>,ordered<span class='op'>=</span><span class='cn'>TRUE</span>,levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Mon'</span>,<span class='st'>'Tue'</span>,<span class='st'>'Wed'</span>,<span class='st'>'Thu'</span>,<span class='st'>'Fri'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>time</span>,into<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'from_time'</span>,<span class='st'>'to_time'</span><span class='op'>)</span>,sep<span class='op'>=</span><span class='st'>' – '</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>from_time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/strptime.html'>strptime</a></span><span class='op'>(</span><span class='va'>from_time</span>,format<span class='op'>=</span><span class='st'>'%I:%M %p'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
           <span class='fu'><a href='https://hms.tidyverse.org/reference/Deprecated.html'>as.hms</a></span><span class='op'>(</span><span class='op'>)</span>,
         to_time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/strptime.html'>strptime</a></span><span class='op'>(</span><span class='va'>to_time</span>,format<span class='op'>=</span><span class='st'>'%I:%M %p'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
           <span class='fu'><a href='https://hms.tidyverse.org/reference/Deprecated.html'>as.hms</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/lm.ridge.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'>#this block uses the map() function from purrr, which we will discuss later in the module</span>
  <span class='fu'>mutate</span><span class='op'>(</span>
    first_name <span class='op'>=</span> <span class='fu'>map_chr</span><span class='op'>(</span><span class='va'>name</span>,<span class='kw'>function</span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span><span class='op'>{</span>
    <span class='op'>(</span><span class='va'>name</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='st'>' '</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>}</span><span class='op'>)</span>,
    last_name <span class='op'>=</span> <span class='fu'>map_chr</span><span class='op'>(</span><span class='va'>name</span>,<span class='kw'>function</span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span><span class='op'>{</span>
    <span class='op'>(</span><span class='va'>name</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='st'>' '</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>}</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>last_name</span><span class='op'>)</span>,<span class='fu'>desc</span><span class='op'>(</span><span class='va'>first_name</span><span class='op'>)</span>,
          <span class='va'>weekday</span>,<span class='va'>from_time</span>,<span class='va'>to_time</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>name_factor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>name</span>,ordered<span class='op'>=</span><span class='cn'>TRUE</span>,levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#Look how tidy this data is!!! This will make plotting much easier in next steps</span>
<span class='va'>time_prefs_joined</span>
</code></pre>
</div>
<pre><code># A tibble: 1,460 x 8
   name  value from_time to_time weekday first_name last_name
   &lt;chr&gt; &lt;ord&gt; &lt;time&gt;    &lt;time&gt;  &lt;ord&gt;   &lt;chr&gt;      &lt;chr&gt;    
 1 Tech~ Yes   08:00     09:00   Mon     Techagumt~ Yanisa   
 2 Tech~ Yes   08:30     09:30   Mon     Techagumt~ Yanisa   
 3 Tech~ Yes   09:00     10:00   Mon     Techagumt~ Yanisa   
 4 Tech~ Yes   11:00     12:00   Mon     Techagumt~ Yanisa   
 5 Tech~ Yes   11:30     12:30   Mon     Techagumt~ Yanisa   
 6 Tech~ Yes   12:00     13:00   Mon     Techagumt~ Yanisa   
 7 Tech~ Yes   12:30     13:30   Mon     Techagumt~ Yanisa   
 8 Tech~ Yes   13:00     14:00   Mon     Techagumt~ Yanisa   
 9 Tech~ Yes   13:30     14:30   Mon     Techagumt~ Yanisa   
10 Tech~ No    14:00     15:00   Mon     Techagumt~ Yanisa   
# ... with 1,450 more rows, and 1 more variable: name_factor &lt;ord&gt;</code></pre>
</div>
<h3 id="visualizing">Visualizing</h3>
<p>This section will focus on visualizing your data using ggplot2. R has several systems for making graphs, but ggplot2 is one of the most elegant and most versatile. ggplot2 implements the <strong>grammar of graphics</strong>, a coherent system for describing and building graphs. With ggplot2, you can do more faster by learning one system and applying it in many places.</p>
<p>If you’d like to learn more about the theoretical underpinnings of ggplot2 before you start, I’d recommend reading “The Layered Grammar of Graphics”, <a href="http://vita.had.co.nz/papers/layered-grammar.pdf" class="uri">http://vita.had.co.nz/papers/layered-grammar.pdf</a>.</p>
<h4 id="first-steps">First steps</h4>
<p>Let’s use our first graph to answer a question: Do cars with big engines use more fuel than cars with small engines? You probably already have an answer, but try to make your answer precise. What does the relationship between engine size and fuel efficiency look like? Is it positive? Negative? Linear? Nonlinear?</p>
<h5 id="the-mpg-data-frame">The <code>mpg</code> data frame</h5>
<p>You can test your answer with the <code>mpg</code> <strong>data frame</strong> found in ggplot2 (aka <code>ggplot2::mpg</code>). A data frame is a rectangular collection of variables (in the columns) and observations (in the rows). <code>mpg</code> contains observations collected by the US Environmental Protection Agency on 38 models of car.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpg</span>
</code></pre>
</div>
<pre><code># A tibble: 234 x 11
   manufacturer model displ  year   cyl trans drv     cty   hwy fl   
   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
 1 audi         a4      1.8  1999     4 auto~ f        18    29 p    
 2 audi         a4      1.8  1999     4 manu~ f        21    29 p    
 3 audi         a4      2    2008     4 manu~ f        20    31 p    
 4 audi         a4      2    2008     4 auto~ f        21    30 p    
 5 audi         a4      2.8  1999     6 auto~ f        16    26 p    
 6 audi         a4      2.8  1999     6 manu~ f        18    26 p    
 7 audi         a4      3.1  2008     6 auto~ f        18    27 p    
 8 audi         a4 q~   1.8  1999     4 manu~ 4        18    26 p    
 9 audi         a4 q~   1.8  1999     4 auto~ 4        16    25 p    
10 audi         a4 q~   2    2008     4 manu~ 4        20    28 p    
# ... with 224 more rows, and 1 more variable: class &lt;chr&gt;</code></pre>
</div>
<p>Among the variables in <code>mpg</code> are:</p>
<ol type="1">
<li><p><code>displ</code>, a car’s engine size, in litres.</p></li>
<li><p><code>hwy</code>, a car’s fuel efficiency on the highway, in miles per gallon (mpg). A car with a low fuel efficiency consumes more fuel than a car with a high fuel efficiency when they travel the same distance.</p></li>
</ol>
<p>To learn more about <code>mpg</code>, open its help page by running <code>?mpg</code>.</p>
<h5 id="creating-a-ggplot">Creating a ggplot</h5>
<p>To plot <code>mpg</code>, run this code to put <code>displ</code> on the x-axis and <code>hwy</code> on the y-axis:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<p>The plot shows a negative relationship between engine size (<code>displ</code>) and fuel efficiency (<code>hwy</code>). In other words, cars with big engines use more fuel. Does this confirm or refute your hypothesis about fuel efficiency and engine size?</p>
<p>With ggplot2, you begin a plot with the function <code>ggplot()</code>. <code>ggplot()</code> creates a coordinate system that you can add layers to. The first argument of <code>ggplot()</code> is the dataset to use in the graph. So <code>ggplot(data = mpg)</code> creates an empty graph, but it’s not very interesting so I’m not going to show it here.</p>
<p>You complete your graph by adding one or more layers to <code>ggplot()</code>. The function <code>geom_point()</code> adds a layer of points to your plot, which creates a scatterplot. ggplot2 comes with many geom functions that each add a different type of layer to a plot. You’ll learn a whole bunch of them throughout this chapter.</p>
<p>Each geom function in ggplot2 takes a <code>mapping</code> argument. This defines how variables in your dataset are mapped to visual properties. The <code>mapping</code> argument is always paired with <code>aes()</code>, and the <code>x</code> and <code>y</code> arguments of <code>aes()</code> specify which variables to map to the x and y axes. ggplot2 looks for the mapped variables in the <code>data</code> argument, in this case, <code>mpg</code>.</p>
<h5 id="a-graphing-template">A graphing template</h5>
<p>Let’s turn this code into a reusable template for making graphs with ggplot2. To make a graph, replace the bracketed sections in the code below with a dataset, a geom function, or a collection of mappings.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</span></code></pre></div>
</div>
<p>The rest of this guide will show you how to complete and extend this template to make different types of graphs. We will begin with the <code>&lt;MAPPINGS&gt;</code> component.</p>
<h4 id="aesthetic-mappings">Aesthetic mappings</h4>
<p>In the plot below, one group of points (highlighted in red) seems to fall outside of the linear trend. These cars have a higher mileage than you might expect. How can you explain these cars?</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<p>Let’s hypothesize that the cars are hybrids. One way to test this hypothesis is to look at the <code>class</code> value for each car. The <code>class</code> variable of the <code>mpg</code> dataset classifies cars into groups such as compact, midsize, and SUV. If the outlying points are hybrids, they should be classified as compact cars or, perhaps, subcompact cars (keep in mind that this data was collected before hybrid trucks and SUVs became popular).</p>
<p>You can add a third variable, like <code>class</code>, to a two dimensional scatterplot by mapping it to an <strong>aesthetic</strong>. An aesthetic is a visual property of the objects in your plot. Aesthetics include things like the size, the shape, or the color of your points. You can display a point (like the one below) in different ways by changing the values of its aesthetic properties. Since we already use the word “value” to describe data, let’s use the word “level” to describe aesthetic properties. Here we change the levels of a point’s size, shape, and color to make the point small, triangular, or blue:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<p>You can convey information about your data by mapping the aesthetics in your plot to the variables in your dataset. For example, you can map the colors of your points to the <code>class</code> variable to reveal the class of each car.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span>, color <span class='op'>=</span> <span class='va'>class</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-16-1.png" width="624" /></p>
</div>
<p>To map an aesthetic to a variable, associate the name of the aesthetic to the name of the variable inside <code>aes()</code>. ggplot2 will automatically assign a unique level of the aesthetic (here a unique color) to each unique value of the variable, a process known as <strong>scaling</strong>. ggplot2 will also add a legend that explains which levels correspond to which values.</p>
<p>The colors reveal that many of the unusual points are two-seater cars. These cars don’t seem like hybrids, and are, in fact, sports cars! Sports cars have large engines like SUVs and pickup trucks, but small bodies like midsize and compact cars, which improves their gas mileage. In hindsight, these cars were unlikely to be hybrids since they have large engines.</p>
<p>In the above example, we mapped <code>class</code> to the color aesthetic, but we could have mapped <code>class</code> to the size aesthetic in the same way. In this case, the exact size of each point would reveal its class affiliation. We get a <em>warning</em> here, because mapping an unordered variable (<code>class</code>) to an ordered aesthetic (<code>size</code>) is not a good idea.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span>, size <span class='op'>=</span> <span class='va'>class</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<p>Or we could have mapped <code>class</code> to the <em>alpha</em> aesthetic, which controls the transparency of the points, or to the shape aesthetic, which controls the shape of the points.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Left</span>
<span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span>, alpha <span class='op'>=</span> <span class='va'>class</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<img src="tidyverse_files/figure-html5/unnamed-chunk-18-1.png" width="50%" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Right</span>
<span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span>, shape <span class='op'>=</span> <span class='va'>class</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-18-2.png" width="50%" /></p>
</div>
<p>What happened to the SUVs? ggplot2 will only use six shapes at a time. By default, additional groups will go unplotted when you use the shape aesthetic.</p>
<p>For each aesthetic, you use <code>aes()</code> to associate the name of the aesthetic with a variable to display. The <code>aes()</code> function gathers together each of the aesthetic mappings used by a layer and passes them to the layer’s mapping argument. The syntax highlights a useful insight about <code>x</code> and <code>y</code>: the x and y locations of a point are themselves aesthetics, visual properties that you can map to variables to display information about the data.</p>
<p>Once you map an aesthetic, ggplot2 takes care of the rest. It selects a reasonable scale to use with the aesthetic, and it constructs a legend that explains the mapping between levels and values. For x and y aesthetics, ggplot2 does not create a legend, but it creates an axis line with tick marks and a label. The axis line acts as a legend; it explains the mapping between locations and values.</p>
<p>You can also <em>set</em> the aesthetic properties of your geom manually. For example, we can make all of the points in our plot blue:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<p>Here, the color doesn’t convey information about a variable, but only changes the appearance of the plot. To set an aesthetic manually, set the aesthetic by name as an argument of your geom function; i.e. it goes <em>outside</em> of <code>aes()</code>. You’ll need to pick a level that makes sense for that aesthetic:</p>
<ul>
<li><p>The name of a color as a character string.</p></li>
<li><p>The size of a point in mm.</p></li>
<li><p>The shape of a point as a number, as shown below.</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<p><img src="tidyverse_files/figure-html5/shapes-1.png" width="75%" /></p>
</div>
<h4 id="facets">Facets</h4>
<p>One way to add additional variables is with aesthetics. Another way, particularly useful for categorical variables, is to split your plot into <strong>facets</strong>, subplots that each display one subset of the data.</p>
<p>To facet your plot by a single variable, use <code>facet_wrap()</code>. The first argument of <code>facet_wrap()</code> should be a formula, which you create with <code>~</code> followed by a variable name (here “formula” is the name of a data structure in R, not a synonym for “equation”). The variable that you pass to <code>facet_wrap()</code> should be discrete.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>class</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<p>To facet your plot on the combination of two variables, add <code>facet_grid()</code> to your plot call. The first argument of <code>facet_grid()</code> is also a formula. This time the formula should contain two variable names separated by a <code>~</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>facet_grid</span><span class='op'>(</span><span class='va'>drv</span> <span class='op'>~</span> <span class='va'>cyl</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<p>If you prefer to not facet in the rows or columns dimension, use a <code>.</code> instead of a variable name, e.g. <code>+ facet_grid(. ~ cyl)</code>.</p>
<h4 id="geometric-objects">Geometric objects</h4>
<p>How are these two plots similar?</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-22-1.png" width="50%" /><img src="tidyverse_files/figure-html5/unnamed-chunk-22-2.png" width="50%" /></p>
</div>
<p>Both plots contain the same x variable, the same y variable, and both describe the same data. But the plots are not identical. Each plot uses a different visual object to represent the data. In ggplot2 syntax, we say that they use different <strong>geoms</strong>.</p>
<p>A <strong>geom</strong> is the geometrical object that a plot uses to represent data. People often describe plots by the type of geom that the plot uses. For example, bar charts use bar geoms, line charts use line geoms, boxplots use boxplot geoms, and so on. Scatterplots break the trend; they use the point geom. As we see above, you can use different geoms to plot the same data. The plot on the left uses the point geom, and the plot on the right uses the smooth geom, a smooth line fitted to the data.</p>
<p>To change the geom in your plot, change the geom function that you add to <code>ggplot()</code>. For instance, to make the plots above, you can use this code:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># left</span>
<span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># right</span>
<span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Every geom function in ggplot2 takes a <code>mapping</code> argument. However, not every aesthetic works with every geom. You could set the shape of a point, but you couldn’t set the “shape” of a line. On the other hand, you <em>could</em> set the linetype of a line. <code>geom_smooth()</code> will draw a different line, with a different linetype, for each unique value of the variable that you map to linetype.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span>, linetype <span class='op'>=</span> <span class='va'>drv</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-24-1.png" width="624" /></p>
</div>
<p>Here <code>geom_smooth()</code> separates the cars into three lines based on their <code>drv</code> value, which describes a car’s drivetrain. One line describes all of the points with a <code>4</code> value, one line describes all of the points with an <code>f</code> value, and one line describes all of the points with an <code>r</code> value. Here, <code>4</code> stands for four-wheel drive, <code>f</code> for front-wheel drive, and <code>r</code> for rear-wheel drive.</p>
<p>If this sounds strange, we can make it more clear by overlaying the lines on top of the raw data and then coloring everything according to <code>drv</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-25-1.png" width="624" /></p>
</div>
<p>Notice that this plot contains two geoms in the same graph! If this makes you excited, buckle up. We will learn how to place multiple geoms in the same plot very soon.</p>
<p>ggplot2 provides over 40 geoms, and extension packages provide even more (see <a href="https://exts.ggplot2.tidyverse.org/gallery/" class="uri">https://exts.ggplot2.tidyverse.org/gallery/</a> for a sampling). The best way to get a comprehensive overview is the ggplot2 cheatsheet, which you can find at <a href="http://rstudio.com/cheatsheets" class="uri">http://rstudio.com/cheatsheets</a>. To learn more about any single geom, use help: <code>?geom_smooth</code>.</p>
<p>Many geoms, like <code>geom_smooth()</code>, use a single geometric object to display multiple rows of data. For these geoms, you can set the <code>group</code> aesthetic to a categorical variable to draw multiple objects. ggplot2 will draw a separate object for each unique value of the grouping variable. In practice, ggplot2 will automatically group the data for these geoms whenever you map an aesthetic to a discrete variable (as in the <code>linetype</code> example). It is convenient to rely on this feature because the group aesthetic by itself does not add a legend or distinguishing features to the geoms.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<img src="tidyverse_files/figure-html5/unnamed-chunk-26-1.png" width="33%" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span>, group <span class='op'>=</span> <span class='va'>drv</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<img src="tidyverse_files/figure-html5/unnamed-chunk-26-2.png" width="33%" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>
    mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span>, color <span class='op'>=</span> <span class='va'>drv</span><span class='op'>)</span>,
    show.legend <span class='op'>=</span> <span class='cn'>FALSE</span>
  <span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-26-3.png" width="33%" /></p>
</div>
<p>To display multiple geoms in the same plot, add multiple geom functions to <code>ggplot()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<p>This, however, introduces some duplication in our code. Imagine if you wanted to change the y-axis to display <code>cty</code> instead of <code>hwy</code>. You’d need to change the variable in two places, and you might forget to update one. You can avoid this type of repetition by passing a set of mappings to <code>ggplot()</code>. ggplot2 will treat these mappings as global mappings that apply to each geom in the graph. In other words, this code will produce the same plot as the previous code:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span>, mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>If you place mappings in a geom function, ggplot2 will treat them as local mappings for the layer. It will use these mappings to extend or overwrite the global mappings <em>for that layer only</em>. This makes it possible to display different aesthetics in different layers.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span>, mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>class</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-29-1.png" width="624" /></p>
</div>
<p>You can use the same idea to specify different <code>data</code> for each layer. Here, our smooth line displays just a subset of the <code>mpg</code> dataset, the subcompact cars. The local data argument in <code>geom_smooth()</code> overrides the global data argument in <code>ggplot()</code> for that layer only.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mpg</span>, mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>displ</span>, y <span class='op'>=</span> <span class='va'>hwy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>class</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>mpg</span>, <span class='va'>class</span> <span class='op'>==</span> <span class='st'>"subcompact"</span><span class='op'>)</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-30-1.png" width="624" /></p>
</div>
<h4 id="cheat-sheet-1">Cheat Sheet</h4>
<p>As with the other sections, until you’ve spent a lot of time using the language (and even when you have!) it is hard to remember all the names of functions used and their parameters and syntaxes. Cheat sheets are helpful to have around!</p>
<p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf"><img src="graphics/images/data-visualization-2.1.png" alt="Data Visualization Cheat Sheet" /></a></p>
<h3 id="example-part-b">Example: Part B</h3>
<p>Below, we’re going to take the data we tidied in Part A and make a plot that quickly demonstrates when people are free for R training. Below is a single ggplot code block, with many comments throughout to explain the different pieces. As discussed above, ggplot code is modular – you can add on as many separate pieces as you want (as long as those pieces are not directly conflicting).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>time_prefs_joined</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_rect</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>
    <span class='co'>#Translating times from hms to POSIXct to take advantage of scale_x_datetime()</span>
    <span class='co'>#Unfortunately there is not an hms specific scale yet</span>
    xmin<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>from_time</span><span class='op'>)</span>,
    xmax<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>to_time</span><span class='op'>)</span>,
    <span class='co'>#This is a bit of a hack, and there are multiple ways to handle this. </span>
    <span class='co'>#Here I am translating the name into a number so I can create a 'width' for the rectangle. </span>
    <span class='co'>#Another way to do this would be to use geom_tile()</span>
    ymin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>name_factor</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>0.5</span>,
    ymax <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>name_factor</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>0.5</span>,
    <span class='co'>#The fill color of each rectangle will be determined by what a person filled in the time block in Doodle with. </span>
    fill <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span>,
    <span class='co'>#Making the rectangles semi-transparent since they overlap</span>
    alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'>#I want a separate subplot for each weekday</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span><span class='va'>weekday</span>,nrow<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'>#Here is the other part of me using the names as ordinal factors to create a rectangle width</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>time_prefs_joined</span><span class='op'>$</span><span class='va'>name_factor</span><span class='op'>)</span><span class='op'>)</span>,
                     labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>time_prefs_joined</span><span class='op'>$</span><span class='va'>name_factor</span><span class='op'>)</span>,
                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>time_prefs_joined</span><span class='op'>$</span><span class='va'>name_factor</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>'Doodle Results for Scheduling R Trainings'</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>'Time of Day (PDT)'</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>ylab</span><span class='op'>(</span><span class='st'>'Participant Name'</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'># Here I am using strftime() formatting codes to simplify the time format displayed</span>
  <span class='fu'>scale_x_datetime</span><span class='op'>(</span>date_labels <span class='op'>=</span> <span class='st'>'%I %p'</span>,date_breaks <span class='op'>=</span> <span class='st'>'1 hour'</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'>#Rotating x axis labels to make them easier to read</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>45</span>, hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,
        text <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-31-1.png" width="3840" /></p>
</div>
<h3 id="purrr">Purrr</h3>
<p>The <a href="https://purrr.tidyverse.org/"><code>purrr</code></a> package has been around for several years now, but with some recent updates across the tidyverse packages, and my recent introduction via some <a href="https://learn.datacamp.com/skill-tracks/intermediate-tidyverse-toolbox?version=1">datacamp courses</a>, it has become a crucial part of my R programming toolbox that I would like to spend some time on.</p>
<p>Iteration is a common feature of programming, and one of the main reasons people want to program in the first place – e.g., ‘I want to do this analysis <strong>for each</strong> sub-unit in my analysis framework’. The typical way to accomplish iteration is through loops, with the most common variety being <code>for</code> loops. For loops are an easy-to-understand way to iterate through an analysis, but they have at least three main drawbacks: 1) they are slow, and 2) a lot of extra unnecessary code is created, 3) they are not modular – pieces of for loops have to be manually copy-pasted, rather than referencing a modular function.</p>
<p><code>purrr</code> allows for the iterative application of functions to data frames. Additionally, it allows for the nesting of data frames - sometimes we will want to isolate pieces of the iterative analysis, and rather than creating a separate data frame for each iteration, we can nest the iterations into one big data frame.</p>
<p>The best overview of <code>purrr</code>’s functionality is in the <a href="https://r4ds.had.co.nz/iteration.html">Iteration chapter of R for Data Science</a>. Some of that chapter is copied here, but it is useful to review the entire chapter for a comprehensive understanding.</p>
<h4 id="for-loops-vs.-functionals">For loops vs. functionals</h4>
<p>For loops are not as important in R as they are in other languages because R is a functional programming language. This means that it’s possible to wrap up for loops in a function, and call that function instead of using the for loop directly.</p>
<p>To see why this is important, consider (again) this simple data frame:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/tibble.html'>tibble</a></span><span class='op'>(</span>
  a <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>,
  b <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>,
  c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>,
  d <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Imagine you want to compute the mean of every column. You could do that with a for loop:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"double"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>output</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>output</span>
</code></pre>
</div>
<pre><code>[1] -0.1243593 -0.6551275 -0.4468224 -0.6536750</code></pre>
</div>
<p>You realise that you’re going to want to compute the means of every column pretty frequently, so you extract it out into a function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>col_mean</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"double"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>output</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>output</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>But then you think it’d also be helpful to be able to compute the median, and the standard deviation, so you copy and paste your <code>col_mean()</code> function and replace the <code>mean()</code> with <code>median()</code> and <code>sd()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>col_median</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"double"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>output</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>output</span>
<span class='op'>}</span>
<span class='va'>col_sd</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"double"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>output</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>output</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Uh oh! You’ve copied-and-pasted this code twice, so it’s time to think about how to generalise it. Notice that most of this code is for-loop boilerplate and it’s hard to see the one thing (<code>mean()</code>, <code>median()</code>, <code>sd()</code>) that is different between the functions.</p>
<p>What would you do if you saw a set of functions like this:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>f1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>^</span> <span class='fl'>1</span>
<span class='va'>f2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>^</span> <span class='fl'>2</span>
<span class='va'>f3</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>^</span> <span class='fl'>3</span>
</code></pre>
</div>
</div>
<p>Hopefully, you’d notice that there’s a lot of duplication, and extract it out into an additional argument:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>f</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>i</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>^</span> <span class='va'>i</span>
</code></pre>
</div>
</div>
<p>You’ve reduced the chance of bugs (because you now have 1/3 of the original code), and made it easy to generalise to new situations.</p>
<p>We can do exactly the same thing with <code>col_mean()</code>, <code>col_median()</code> and <code>col_sd()</code> by adding an argument that supplies the function to apply to each column:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>col_summary</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>fun</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"double"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>out</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>fun</span><span class='op'>(</span><span class='va'>df</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>out</span>
<span class='op'>}</span>
<span class='fu'>col_summary</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>median</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -0.3349320 -0.7853201 -0.2853444 -0.7316654</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>col_summary</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -0.1243593 -0.6551275 -0.4468224 -0.6536750</code></pre>
</div>
<p>The idea of passing a function to another function is an extremely powerful idea, and it’s one of the behaviours that makes R a functional programming language. It might take you a while to wrap your head around the idea, but it’s worth the investment. In the rest of the chapter, you’ll learn about and use the <strong>purrr</strong> package, which provides functions that eliminate the need for many common for loops. The apply family of functions in base R (<code>apply()</code>, <code>lapply()</code>, <code>tapply()</code>, etc) solve a similar problem, but purrr is more consistent and thus is easier to learn.</p>
<p>The goal of using purrr functions instead of for loops is to allow you to break common list manipulation challenges into independent pieces:</p>
<ol type="1">
<li><p>How can you solve the problem for a single element of the list? Once you’ve solved that problem, purrr takes care of generalising your solution to every element in the list.</p></li>
<li><p>If you’re solving a complex problem, how can you break it down into bite-sized pieces that allow you to advance one small step towards a solution? With purrr, you get lots of small pieces that you can compose together with the pipe.</p></li>
</ol>
<p>This structure makes it easier to solve new problems. It also makes it easier to understand your solutions to old problems when you re-read your old code.</p>
<h4 id="the-map-functions">The map functions</h4>
<p>The pattern of looping over a vector, doing something to each element and saving the results is so common that the purrr package provides a family of functions to do it for you. There is one function for each type of output:</p>
<ul>
<li><code>map()</code> makes a list.</li>
<li><code>map_lgl()</code> makes a logical vector.</li>
<li><code>map_int()</code> makes an integer vector.</li>
<li><code>map_dbl()</code> makes a double vector.</li>
<li><code>map_chr()</code> makes a character vector.</li>
</ul>
<p>Each function takes a vector as input, applies a function to each piece, and then returns a new vector that’s the same length (and has the same names) as the input. The type of the vector is determined by the suffix to the map function.</p>
<p>Once you master these functions, you’ll find it takes much less time to solve iteration problems. But you should never feel bad about using a for loop instead of a map function. The map functions are a step up a tower of abstraction, and it can take a long time to get your head around how they work. The important thing is that you solve the problem that you’re working on, not write the most concise and elegant code (although that’s definitely something you want to strive towards!).</p>
<p>Some people will tell you to avoid for loops because they are slow. They’re wrong! (Well at least they’re rather out of date, as for loops haven’t been slow for many years.) The chief benefits of using functions like <code>map()</code> is not speed, but clarity: they make your code easier to write and to read.</p>
<p>We can use these functions to perform the same computations as the last for loop. Those summary functions returned doubles, so we need to use <code>map_dbl()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.1243593 -0.6551275 -0.4468224 -0.6536750 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>median</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.3349320 -0.7853201 -0.2853444 -0.7316654 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>sd</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        a         b         c         d 
0.5514339 0.9622260 0.7566685 1.2473080 </code></pre>
</div>
<p>Compared to using a for loop, focus is on the operation being performed (i.e. <code>mean()</code>, <code>median()</code>, <code>sd()</code>), not the bookkeeping required to loop over every element and store the output. This is even more apparent if we use the pipe:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span> <span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.1243593 -0.6551275 -0.4468224 -0.6536750 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span> <span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>median</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.3349320 -0.7853201 -0.2853444 -0.7316654 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span> <span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>sd</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        a         b         c         d 
0.5514339 0.9622260 0.7566685 1.2473080 </code></pre>
</div>
<p>There are a few differences between <code>map_*()</code> and <code>col_summary()</code>:</p>
<ul>
<li><p>All purrr functions are implemented in C. This makes them a little faster at the expense of readability.</p></li>
<li><p>The second argument, <code>.f</code>, the function to apply, can be a formula, a character vector, or an integer vector. You’ll learn about those handy shortcuts in the next section.</p></li>
<li><p><code>map_*()</code> uses … ([dot dot dot]) to pass along additional arguments to <code>.f</code> each time it’s called:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>mean</span>, trim <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.3349320 -0.7853201 -0.2853444 -0.7316654 </code></pre>
</div></li>
<li><p>The map functions also preserve names:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, y <span class='op'>=</span> <span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
<span class='fu'>map_int</span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>x y 
3 2 </code></pre>
</div></li>
</ul>
<h3 id="shortcuts">Shortcuts</h3>
<p>There are a few shortcuts that you can use with <code>.f</code> in order to save a little typing. Imagine you want to fit a linear model to each group in a dataset. The following toy example splits up the <code>mtcars</code> dataset into three pieces (one for each value of cylinder) and fits the same linear model to each piece:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>models</span> <span class='op'>&lt;-</span> <span class='va'>mtcars</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>$</span><span class='va'>cyl</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>wt</span>, data <span class='op'>=</span> <span class='va'>df</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The syntax for creating an anonymous function in R is quite verbose so purrr provides a convenient shortcut: a one-sided formula.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>models</span> <span class='op'>&lt;-</span> <span class='va'>mtcars</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>$</span><span class='va'>cyl</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map</span><span class='op'>(</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>wt</span>, data <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Here I’ve used <code>.</code> as a pronoun: it refers to the current list element (in the same way that <code>i</code> referred to the current index in the for loop).</p>
<p>When you’re looking at many models, you might want to extract a summary statistic like the <span class="math inline">\(R^2\)</span>. To do that we need to first run <code>summary()</code> and then extract the component called <code>r.squared</code>. We could do that using the shorthand for anonymous functions:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>models</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map</span><span class='op'>(</span><span class='va'>summary</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map_dbl</span><span class='op'>(</span><span class='op'>~</span><span class='va'>.</span><span class='op'>$</span><span class='va'>r.squared</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        4         6         8 
0.5086326 0.4645102 0.4229655 </code></pre>
</div>
<p>But extracting named components is a common operation, so purrr provides an even shorter shortcut: you can use a string.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>models</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map</span><span class='op'>(</span><span class='va'>summary</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map_dbl</span><span class='op'>(</span><span class='st'>"r.squared"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        4         6         8 
0.5086326 0.4645102 0.4229655 </code></pre>
</div>
<p>You can also use an integer to select elements by position:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>7</span>, <span class='fl'>8</span>, <span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>%&gt;%</span> <span class='fu'>map_dbl</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2 5 8</code></pre>
</div>
<h4 id="the-map-functions-1">The map functions</h4>
<p>The pattern of looping over a vector, doing something to each element and saving the results is so common that the purrr package provides a family of functions to do it for you. There is one function for each type of output:</p>
<ul>
<li><code>map()</code> makes a list.</li>
<li><code>map_lgl()</code> makes a logical vector.</li>
<li><code>map_int()</code> makes an integer vector.</li>
<li><code>map_dbl()</code> makes a double vector.</li>
<li><code>map_chr()</code> makes a character vector.</li>
</ul>
<p>Each function takes a vector as input, applies a function to each piece, and then returns a new vector that’s the same length (and has the same names) as the input. The type of the vector is determined by the suffix to the map function.</p>
<p>Once you master these functions, you’ll find it takes much less time to solve iteration problems. But you should never feel bad about using a for loop instead of a map function. The map functions are a step up a tower of abstraction, and it can take a long time to get your head around how they work. The important thing is that you solve the problem that you’re working on, not write the most concise and elegant code (although that’s definitely something you want to strive towards!).</p>
<p>Some people will tell you to avoid for loops because they are slow. They’re wrong! (Well at least they’re rather out of date, as for loops haven’t been slow for many years.) The chief benefits of using functions like <code>map()</code> is not speed, but clarity: they make your code easier to write and to read.</p>
<p>We can use these functions to perform the same computations as the last for loop. Those summary functions returned doubles, so we need to use <code>map_dbl()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.1243593 -0.6551275 -0.4468224 -0.6536750 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>median</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.3349320 -0.7853201 -0.2853444 -0.7316654 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>sd</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        a         b         c         d 
0.5514339 0.9622260 0.7566685 1.2473080 </code></pre>
</div>
<p>Compared to using a for loop, focus is on the operation being performed (i.e. <code>mean()</code>, <code>median()</code>, <code>sd()</code>), not the bookkeeping required to loop over every element and store the output. This is even more apparent if we use the pipe:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span> <span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.1243593 -0.6551275 -0.4468224 -0.6536750 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span> <span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>median</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.3349320 -0.7853201 -0.2853444 -0.7316654 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span> <span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>sd</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        a         b         c         d 
0.5514339 0.9622260 0.7566685 1.2473080 </code></pre>
</div>
<p>There are a few differences between <code>map_*()</code> and <code>col_summary()</code>:</p>
<ul>
<li><p>All purrr functions are implemented in C. This makes them a little faster at the expense of readability.</p></li>
<li><p>The second argument, <code>.f</code>, the function to apply, can be a formula, a character vector, or an integer vector. You’ll learn about those handy shortcuts in the next section.</p></li>
<li><p><code>map_*()</code> uses … ([dot dot dot]) to pass along additional arguments to <code>.f</code> each time it’s called:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>mean</span>, trim <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         a          b          c          d 
-0.3349320 -0.7853201 -0.2853444 -0.7316654 </code></pre>
</div></li>
<li><p>The map functions also preserve names:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, y <span class='op'>=</span> <span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
<span class='fu'>map_int</span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>x y 
3 2 </code></pre>
</div></li>
</ul>
<h4 id="mapping-over-multiple-arguments">Mapping over multiple arguments</h4>
<p>So far we’ve mapped along a single input. But often you have multiple related inputs that you need iterate along in parallel. That’s the job of the <code>map2()</code> and <code>pmap()</code> functions. For example, imagine you want to simulate some random normals with different means. You know how to do that with <code>map()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>10</span>, <span class='op'>-</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>mu</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map</span><span class='op'>(</span><span class='va'>rnorm</span>, n <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>List of 3
 $ : num [1:5] 6.17 7.07 3.73 5.76 5.72
 $ : num [1:5] 11.44 9.61 11.19 10.26 9.11
 $ : num [1:5] -2.785 -0.503 -3.326 -2.983 -3.94</code></pre>
</div>
<p>What if you also want to vary the standard deviation? One way to do that would be to iterate over the indices and index into vectors of means and sds:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>5</span>, <span class='fl'>10</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>mu</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map</span><span class='op'>(</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='va'>mu</span><span class='op'>[[</span><span class='va'>.</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>sigma</span><span class='op'>[[</span><span class='va'>.</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>List of 3
 $ : num [1:5] 5.37 7.48 6.08 5.86 6.55
 $ : num [1:5] 16.29 14.32 16.17 16.24 4.52
 $ : num [1:5] 1.48 -5.86 -4.26 5.31 -14.76</code></pre>
</div>
<p>But that obfuscates the intent of the code. Instead we could use <code>map2()</code> which iterates over two vectors in parallel:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>map2</span><span class='op'>(</span><span class='va'>mu</span>, <span class='va'>sigma</span>, <span class='va'>rnorm</span>, n <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>List of 3
 $ : num [1:5] 5.26 4.66 5.12 5.9 4.3
 $ : num [1:5] 10.42 11.73 5.96 11.68 13.69
 $ : num [1:5] 9.27 -14.72 -18.26 8.19 -13.09</code></pre>
</div>
<p><code>map2()</code> generates this series of function calls:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="graphics/diagrams/lists-map2.png" width="405" /></p>
</div>
<p>Note that the arguments that vary for each call come <em>before</em> the function; arguments that are the same for every call come <em>after</em>.</p>
<p>Like <code>map()</code>, <code>map2()</code> is just a wrapper around a for loop:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>map2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>f</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"list"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>out</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>f</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>y</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>...</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>out</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>You could also imagine <code>map3()</code>, <code>map4()</code>, <code>map5()</code>, <code>map6()</code> etc, but that would get tedious quickly. Instead, purrr provides <code>pmap()</code> which takes a list of arguments. You might use that if you wanted to vary the mean, standard deviation, and number of samples:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span>
<span class='va'>args1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>mu</span>, <span class='va'>sigma</span><span class='op'>)</span>
<span class='va'>args1</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pmap</span><span class='op'>(</span><span class='va'>rnorm</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>List of 3
 $ : num 5.9
 $ : num [1:3] 3.12 13.19 20.37
 $ : num [1:5] -1.86 -12.53 -10.05 -18.01 -1.93</code></pre>
</div>
<p>That looks like:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="graphics/diagrams/lists-pmap-unnamed.png" width="427" /></p>
</div>
<p>If you don’t name the list’s elements, <code>pmap()</code> will use positional matching when calling the function. That’s a little fragile, and makes the code harder to read, so it’s better to name the arguments:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>args2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='va'>mu</span>, sd <span class='op'>=</span> <span class='va'>sigma</span>, n <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span>
<span class='va'>args2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pmap</span><span class='op'>(</span><span class='va'>rnorm</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>That generates longer, but safer, calls:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="graphics/diagrams/lists-pmap-named.png" width="548" /></p>
</div>
<p>Since the arguments are all the same length, it makes sense to store them in a data frame:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>params</span> <span class='op'>&lt;-</span> <span class='fu'>tribble</span><span class='op'>(</span>
  <span class='op'>~</span><span class='va'>mean</span>, <span class='op'>~</span><span class='va'>sd</span>, <span class='op'>~</span><span class='va'>n</span>,
    <span class='fl'>5</span>,     <span class='fl'>1</span>,  <span class='fl'>1</span>,
   <span class='fl'>10</span>,     <span class='fl'>5</span>,  <span class='fl'>3</span>,
   <span class='op'>-</span><span class='fl'>3</span>,    <span class='fl'>10</span>,  <span class='fl'>5</span>
<span class='op'>)</span>
<span class='va'>params</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pmap</span><span class='op'>(</span><span class='va'>rnorm</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[[1]]
[1] 6.615646

[[2]]
[1]  6.204123 14.402442  3.407024

[[3]]
[1]  -4.205694   3.943144   5.266949  -4.025437 -11.403292</code></pre>
</div>
<p>As soon as your code gets complicated, I think a data frame is a good approach because it ensures that each column has a name and is the same length as all the other columns.</p>
<h4 id="cheat-sheet-2">Cheat Sheet</h4>
<p>As with the other sections, <code>purrr</code> has a great cheat sheet to help you remember the main uses of the package.</p>
<p><a href="https://github.com/rstudio/cheatsheets/raw/master/purrr.pdf"><img src="graphics/images/purrr.png" alt="Functional Programming with purr Cheat Sheet" /></a></p>
<h3 id="example-part-c">Example: Part C</h3>
<p>What if we wanted to clean up the plot we created above up a little bit – we had a bunch of overlapping time blocks because of the way the doodle poll was taken. But what we really care about is when a person is free and when a person is otherwise occupied. Instead of keeping a record of their status for every potential overlapping appointment, can we group together blocks where they are free or occupied for a simpler plot? See how below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>time_prefs_clean</span> <span class='op'>=</span> <span class='va'>time_prefs_joined</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/lm.ridge.html'>select</a></span><span class='op'>(</span><span class='va'>name</span>,<span class='va'>name_factor</span>,<span class='va'>first_name</span>,<span class='va'>last_name</span>,
         <span class='va'>weekday</span>,<span class='va'>from_time</span>,<span class='va'>to_time</span>,<span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'>#I want to nest the data specific to each person a data frame to be operated on separately for each iteration</span>
  <span class='fu'>nest</span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>weekday</span>,<span class='va'>from_time</span>,<span class='va'>to_time</span>,<span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'>#I then use map() to apply an anonymous function (a function defined on the fly) below</span>
  <span class='fu'>mutate</span><span class='op'>(</span>cleaned_time_blocks <span class='op'>=</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>data</span>,<span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>{</span>
    
    <span class='co'>#I need to create a group number each time a person's status changes to I can group those time blocks together</span>
    <span class='va'>grouped</span> <span class='op'>=</span> <span class='va'>data</span> <span class='op'>%&gt;%</span>
      <span class='co'>#Initialize group as 1</span>
      <span class='fu'>mutate</span><span class='op'>(</span>group_num <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
    
    <span class='va'>gn</span> <span class='op'>=</span> <span class='fl'>1</span>
    
    <span class='co'>#start on the second entry -- in this case for loops are still necessary </span>
    <span class='co'>#because of the tracking of the current group number across rows</span>
    <span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>grouped</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
      <span class='co'>#If the status has changed or the day has changed, create and assign a new group</span>
      <span class='kw'>if</span><span class='op'>(</span><span class='va'>grouped</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>!=</span> <span class='va'>grouped</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>|</span>
         <span class='va'>grouped</span><span class='op'>$</span><span class='va'>weekday</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>!=</span> <span class='va'>grouped</span><span class='op'>$</span><span class='va'>weekday</span><span class='op'>[</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>{</span>
        <span class='va'>gn</span> <span class='op'>=</span> <span class='va'>gn</span><span class='op'>+</span><span class='fl'>1</span>
        <span class='va'>grouped</span><span class='op'>$</span><span class='va'>group_num</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>gn</span>
      <span class='op'>}</span><span class='kw'>else</span><span class='op'>{</span>
        <span class='va'>grouped</span><span class='op'>$</span><span class='va'>group_num</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>gn</span>
      <span class='op'>}</span>
    <span class='op'>}</span>
    
    <span class='co'>#Calculate the bounding times of each group we created</span>
    <span class='va'>clean</span> <span class='op'>=</span> <span class='va'>grouped</span> <span class='op'>%&gt;%</span>
      <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>weekday</span>,<span class='va'>group_num</span>,<span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://r-spatial.github.io/sf/reference/tidyverse.html'>summarise</a></span><span class='op'>(</span>min_time <span class='op'>=</span> <span class='fu'><a href='https://hms.tidyverse.org/reference/Deprecated.html'>as.hms</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>from_time</span><span class='op'>)</span><span class='op'>)</span>,
                max_time <span class='op'>=</span> <span class='fu'><a href='https://hms.tidyverse.org/reference/Deprecated.html'>as.hms</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>to_time</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

    <span class='co'>#Return the grouped data frame</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>clean</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'>#Get rid of the old data frames</span>
  <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/lm.ridge.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>data</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'>#Unnest the clean data frames, so we have one big data frame for plotting together</span>
  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>cleaned_time_blocks</span><span class='op'>)</span>


<span class='co'>#Refer to plotting in part B -- very similar implementation</span>
<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>time_prefs_clean</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_rect</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>xmin<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>min_time</span><span class='op'>)</span>,
                xmax<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>max_time</span><span class='op'>)</span>,
                ymin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>name_factor</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>0.5</span>,
                ymax <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>name_factor</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>0.5</span>,
                fill <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span>,
            color<span class='op'>=</span><span class='st'>'white'</span>,size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span><span class='va'>weekday</span>,nrow<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>time_prefs_joined</span><span class='op'>$</span><span class='va'>name_factor</span><span class='op'>)</span><span class='op'>)</span>,
                     labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>time_prefs_joined</span><span class='op'>$</span><span class='va'>name_factor</span><span class='op'>)</span>,
                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>time_prefs_joined</span><span class='op'>$</span><span class='va'>name_factor</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>'Cleaner Doodle Results for Scheduling R Trainings'</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>'Time of Day (PDT)'</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>ylab</span><span class='op'>(</span><span class='st'>'Participant Name'</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_x_datetime</span><span class='op'>(</span>date_labels <span class='op'>=</span> <span class='st'>'%I %p'</span>,date_breaks <span class='op'>=</span> <span class='st'>'1 hour'</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>45</span>, hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,
        text <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="tidyverse_files/figure-html5/unnamed-chunk-62-1.png" width="3840" /></p>
</div>
<p>Viola! That is it for this lesson – we have spent some time on tidying, transforming, and visualizing. Of course your learning does not end here – I have included a number of resources for review below that will help you delve deeper into and master these topics.</p>
<h2 id="reference-materials">Reference Materials</h2>
<h3 id="run-through-the-example-code-yourself">Run Through the Example Code Yourself</h3>
<p>You can run through the example yourself based on the example code and data, which you can get by cloning (or just downloading as a ZIP) the <a href="https://github.com/PerkinsAndWill/nn_r_training">GitHub repository</a> for this course and navigating to the <code>topics_setup/01_tidyverse</code> directory. There you will see <code>example_code.R</code>, and the raw Doodle results in the <code>data</code> folder.</p>
<h3 id="cheat-sheets">Cheat Sheets</h3>
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">Data import</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">Data Transformation with dplyr</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">Data Visualization with ggplot2</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/lubridate.pdf">Dates and times with lubridate</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/purrr.pdf">Apply functions with purrr</a></li>
</ul>
<h3 id="further-reading">Further Reading</h3>
<ul>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a>, by Garrett Grolemund and Hadley Wickham. As mentioned above, some of the content for this module is copied directly from that book.</li>
</ul>
<h3 id="related-datacamp-courses">Related DataCamp Courses</h3>
<ul>
<li><a href="https://learn.datacamp.com/skill-tracks/tidyverse-fundamentals">Tidyverse Fundamentals course track (5 courses, 20 hours)</a></li>
<li><a href="https://learn.datacamp.com/skill-tracks/intermediate-tidyverse-toolbox?version=1">Intermediate Tidyverse Toolbox course track (4 courses, 16 hours)</a></li>
<li><a href="https://learn.datacamp.com/courses/working-with-dates-and-times-in-r">Working with Dates and Times in R (1 course, 4 hours)</a></li>
<li><a href="https://learn.datacamp.com/skill-tracks/data-visualization-with-r">Data Visualization with R course track (3 courses, 12 hours)</a></li>
</ul>
<p><em>This content was presented to Nelson\Nygaard Staff at a Lunch and Learn webinar on Friday, August 21st, 2020, and is <a href="https://web.microsoftstream.com/video/33fc95ba-c50e-4ac0-b9e4-118217352133">available as a recording here</a> and embedded at the top of the page.</em></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
